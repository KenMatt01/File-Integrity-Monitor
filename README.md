# File Integrity Monitor using Hashing Algorithms

### Description
A File Integrity Monitor (FIM) is a security tool that tracks changes to critical system files by calculating and comparing hash values. Here's how it works:

- Initial Hash Calculation: When the system or files are first monitored, the FIM computes a cryptographic hash (e.g., MD5, SHA-256) for each file. This hash uniquely represents the file's current content.

- Ongoing Monitoring: The FIM periodically re-calculates the hash values of these files during operation.

- Change Detection: If any file is modified, even slightly, its hash value will change. The FIM detects this alteration by comparing the new hash with the original. If they differ, it raises an alert indicating a possible unauthorized change.

- Response: Upon detection, the system can log the change, notify administrators, or even trigger an automated response to investigate or revert the change.

### Languages & utilities
- Powershell

### Libraries & tools
- Get-FileHash
- FileSystemWatcher
- Send-MailMessage
- Windows Event Logs

### Environment
- Windows 11

### System Development Methodology

![Screenshot 2024-10-02 003259](https://github.com/user-attachments/assets/6b04d7aa-3303-4944-b4df-bb006f4dbc53)

### Working

1. Collect new baseline<br>

![Screenshot 2023-07-26 174542](https://github.com/user-attachments/assets/1fc5b415-eb5d-4d4c-91a3-3f9eda2914b4)<br>
   When the script is run, it asks the user to select between two options –<br>
A – Collect a new baseline for the target files<br>
B – Begin Monitoring Files with existing baseline<br>
If option A is selected, the script collects a fresh new baseline for the target files in the directory.


2. Begin file monitoring with new baseline<br>

![Screenshot 2023-07-26 174611](https://github.com/user-attachments/assets/16cc0fa0-5028-4af9-8ee3-cebf12bebec2)<br>
   When option B is selected, the system starts actively monitoring files in the directory and when changes occur, they are reported on the console. The system reports if a file has been changed, created, or deleted. The system keeps monitoring files until it has been stopped.


3. Baseline.txt<br>

![baseline](https://github.com/user-attachments/assets/472bdc13-f75b-4931-9a6d-3f86d312affd)<br>
   This is text file created by the system to store baseline of the target file. The text file contains the path of the file with the corresponding “SHA512” hash algorithm of the files. The baseline is updated every time the user selects option A to create a new baseline


4. Log.txt<br>

![log](https://github.com/user-attachments/assets/f4cd9ce5-7a31-436e-8195-0d2ad7d3b1dd)<br>
   This is the text file created to keep track of all logs created by the system in the event of changes. These text files provide a deeper insight about the changes and if any discrepancies occur in the system.


5. Report.txt<br>

![report](https://github.com/user-attachments/assets/d5ec438d-d210-4e4c-81ad-58085e3c2631)<br>
   This text file is created to store the report generated by the system of the latest monitoring activities. This file is also used to generate the report for the user which is then attached in the email alert notification during changes.


6. Email Alerts<br>

![Screenshot 2024-10-02 143959](https://github.com/user-attachments/assets/479a5ee7-bfe6-4762-a2eb-f8128e6efea1)<br>
   These screenshots are of email alerts sent to user in the event of changes. The alert 	consists of the change made, the file path, the corresponding hash algorithm, and the 	report generated by the system. Such a feature makes it easier and faster to detect 	changes and can be easily passed to an expert if further study is required.


7. Error Handling<br>

![error](https://github.com/user-attachments/assets/a0daef45-5886-4bae-95d7-4ca91d05aa8e)<br>
This interface is displayed when errors occur during baseline collection, monitoring, or report generation.



